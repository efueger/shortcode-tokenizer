{"version":3,"sources":["shortcode-tokenizer.min.js"],"names":["root","factory","exports","module","define","amd","this","modules","__webpack_require__","moduleId","installedModules","id","loaded","call","m","c","p","_toConsumableArray","arr","Array","isArray","i","arr2","length","from","_classCallCheck","instance","Constructor","TypeError","Object","defineProperty","value","_createClass","defineProperties","target","props","descriptor","enumerable","configurable","writable","key","protoProps","staticProps","prototype","Token","type","body","pos","arguments","undefined","children","params","isClosed","SELF_CLOSING","CLOSE","name","substring","OPEN","match","rxOpen","rxSelfclosing","SyntaxError","token","TEXT","RX_KEY","RX_PARAM","RX_PARAMS","RX_ENCLOSURE","RX_OPEN","RX_SELFCLOSING","RX_CLOSE","rxEnclosure","RegExp","rxClose","ShortcodeTokenizer","buf","tokens","strict","input","Error","originalBuf","_token","concat","push","ast","stack","parent","shift","canClose","pop","unshift","index","_getNotTextType","str","default","assign"],"mappings":"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","file":"shortcode-tokenizer.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"shortcodeTokenizer\"] = factory();\n\telse\n\t\troot[\"shortcodeTokenizer\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Token = exports.Token = function () {\n\t  function Token(type, body) {\n\t    var pos = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n\t\n\t    _classCallCheck(this, Token);\n\t\n\t    this.type = type;\n\t    this.body = body;\n\t    this.pos = pos;\n\t    this.children = [];\n\t    this.params = [];\n\t    this.isClosed = type === SELF_CLOSING;\n\t\n\t    switch (this.type) {\n\t      case CLOSE:\n\t        this.name = this.body.substring(2, this.body.length - 1);\n\t        break;\n\t      case OPEN:\n\t      case SELF_CLOSING:\n\t        var match = this.body.match(this.type === OPEN ? rxOpen : rxSelfclosing);\n\t        if (match === null) {\n\t          throw new SyntaxError('Invalid ' + this.type + ' token: ' + this.body);\n\t        }\n\t        this.name = match[1];\n\t        break;\n\t      default:\n\t        break;\n\t    }\n\t  }\n\t\n\t  _createClass(Token, [{\n\t    key: 'canClose',\n\t    value: function canClose(token) {\n\t      return this.name === token.name;\n\t    }\n\t  }]);\n\t\n\t  return Token;\n\t}();\n\t\n\tvar TEXT = exports.TEXT = 'TEXT';\n\tvar OPEN = exports.OPEN = 'OPEN';\n\tvar CLOSE = exports.CLOSE = 'CLOSE';\n\tvar SELF_CLOSING = exports.SELF_CLOSING = 'SELF_CLOSING';\n\t\n\t/* eslint-disable */\n\tvar RX_KEY = '[a-zA-Z0-9_]+';\n\t\n\tvar RX_PARAM = RX_KEY + // flags\n\t'|' + RX_KEY + '=\\\\d+\\\\.\\\\d+' + // floats\n\t'|' + RX_KEY + '=\\\\d+' + // ints\n\t'|' + RX_KEY + '=\"[^\\\\]\"]*\"' + // double-qouted strings\n\t'|' + RX_KEY + '=\\'[^\\\\]\\']*\\''; // single-qouted strings\n\t\n\tvar RX_PARAMS = '(\\\\s((' + RX_PARAM + ')((?!\\\\s+/?\\\\])\\\\s|))+)?';\n\t\n\tvar RX_ENCLOSURE = '\\\\[\\\\/?[a-zA-Z][^\\\\]]+\\\\]';\n\tvar RX_OPEN = '\\\\[(' + RX_KEY + ')' + RX_PARAMS + '\\\\]';\n\tvar RX_SELFCLOSING = '\\\\[(' + RX_KEY + ')' + RX_PARAMS + '\\\\s?\\\\/\\\\]';\n\tvar RX_CLOSE = '\\\\[\\\\/(' + RX_KEY + ')\\\\]';\n\t\n\tvar rxEnclosure = new RegExp(RX_ENCLOSURE);\n\tvar rxOpen = new RegExp(RX_OPEN, 'i');\n\tvar rxClose = new RegExp(RX_CLOSE, 'i');\n\tvar rxSelfclosing = new RegExp(RX_SELFCLOSING, 'i');\n\t/* eslint-enable */\n\t\n\tvar ShortcodeTokenizer = function () {\n\t  function ShortcodeTokenizer() {\n\t    _classCallCheck(this, ShortcodeTokenizer);\n\t\n\t    this.buf = null;\n\t    this.pos = 0;\n\t    this.tokens = [];\n\t    this.strict = true;\n\t  }\n\t\n\t  _createClass(ShortcodeTokenizer, [{\n\t    key: 'tokenize',\n\t    value: function tokenize(input) {\n\t      if (typeof input !== 'string') {\n\t        throw new Error('Invalid input');\n\t      }\n\t\n\t      this.buf = this.originalBuf = input;\n\t      this.pos = 0;\n\t      this.tokens = [];\n\t\n\t      // Get tokens\n\t      var token = void 0;\n\t      while ((token = this._token()) !== null) {\n\t        if (Array.isArray(token)) {\n\t          this.tokens = [].concat(_toConsumableArray(this.tokens), _toConsumableArray(token));\n\t        } else {\n\t          this.tokens.push(token);\n\t        }\n\t      }\n\t      return this;\n\t    }\n\t  }, {\n\t    key: 'getTokens',\n\t    value: function getTokens() {\n\t      return this.tokens;\n\t    }\n\t  }, {\n\t    key: 'ast',\n\t    value: function ast() {\n\t      var stack = [];\n\t      var ast = [];\n\t      var tokens = [].concat(_toConsumableArray(this.tokens));\n\t      var parent = null;\n\t      var token = void 0;\n\t      while (token = tokens.shift()) {\n\t        if (token.type === TEXT) {\n\t          if (!parent) {\n\t            ast.push(token);\n\t          } else {\n\t            parent.children.push(token);\n\t          }\n\t        } else if (token.type === OPEN) {\n\t          if (parent === null) {\n\t            parent = token;\n\t            ast.push(parent);\n\t          } else {\n\t            parent.children.push(token);\n\t            stack.push(parent);\n\t            parent = token;\n\t          }\n\t        } else if (token.type === CLOSE) {\n\t          if (parent === null || !token.canClose(parent)) {\n\t            if (this.strict) {\n\t              throw new SyntaxError('Unmatched close token: ' + token.body);\n\t            } else {\n\t              // convert to text\n\t              tokens.unshift(new Token(TEXT, token.body));\n\t            }\n\t          } else {\n\t            parent.isClosed = true;\n\t            parent = stack.pop();\n\t          }\n\t        } else if (token.type === SELF_CLOSING) {\n\t          ast.push(token);\n\t        } else {\n\t          throw new SyntaxError('Unknown token: ' + token.type);\n\t        }\n\t      }\n\t      return ast;\n\t    }\n\t  }, {\n\t    key: '_token',\n\t    value: function _token() {\n\t      if (!this.buf) {\n\t        return null;\n\t      }\n\t\n\t      var match = this.buf.match(rxEnclosure);\n\t\n\t      // all text\n\t      if (match === null) {\n\t        var token = new Token(TEXT, this.buf, this.pos);\n\t        this.pos += this.buf.length;\n\t        this.buf = null;\n\t        return token;\n\t      }\n\t\n\t      var tokens = [];\n\t\n\t      // first part is text\n\t      if (match.index !== 0) {\n\t        tokens.push(new Token(TEXT, this.buf.substring(0, match.index), this.pos));\n\t      }\n\t\n\t      // matching token\n\t      tokens.push(new Token(this._getNotTextType(match[0]), match[0], this.pos + match.index));\n\t\n\t      // shorten buffer\n\t      this.buf = this.buf.substring(match.index + match[0].length);\n\t      this.pos += match.index + match[0].length;\n\t      if (this.buf.length === 0) {\n\t        this.buf = null;\n\t      }\n\t      return tokens;\n\t    }\n\t  }, {\n\t    key: '_getNotTextType',\n\t    value: function _getNotTextType(str) {\n\t      if (str[1] === '/') {\n\t        return CLOSE;\n\t      }\n\t      if (str[str.length - 2] === '/') {\n\t        return SELF_CLOSING;\n\t      }\n\t      return OPEN;\n\t    }\n\t  }]);\n\t\n\t  return ShortcodeTokenizer;\n\t}();\n\t\n\texports.default = ShortcodeTokenizer;\n\t\n\t\n\tObject.assign(ShortcodeTokenizer, {\n\t  TEXT: TEXT,\n\t  OPEN: OPEN,\n\t  CLOSE: CLOSE,\n\t  SELF_CLOSING: SELF_CLOSING,\n\t  rxEnclosure: rxEnclosure,\n\t  rxOpen: rxOpen,\n\t  rxClose: rxClose,\n\t  rxSelfclosing: rxSelfclosing\n\t});\n\n/***/ }\n/******/ ])\n});\n;\n"],"sourceRoot":"/source/"}